<!--settings.wxml-->
<view class="container">
  <view class="settings-content">
    <!-- 个人设置 -->
    <view class="settings-section">
      <view class="section-title">个人设置</view>
      <t-cell-group>
        <!-- 所属组织 -->
        <t-cell title="所属组织" bind:click="onSelectOrganization">
          <view class="picker-text">
            {{userSettings.organizationName || '请选择组织'}}
          </view>
          <view slot="right-icon" class="custom-arrow">›</view>
        </t-cell>

        <!-- 所属城市 -->
        <t-cell title="所属城市" bind:click="onSelectCity">
          <view class="picker-text">
            {{userSettings.cityName || '请选择城市'}}
          </view>
          <view slot="right-icon" class="custom-arrow">›</view>
        </t-cell>
      </t-cell-group>
    </view>

    <!-- 存储设置 -->
    <view class="settings-section">
      <view class="section-title">存储设置</view>
      <t-cell-group>
        <t-cell title="清除缓存" bind:click="onClearCache">
          <view class="cache-size">约 2.5MB</view>
          <view slot="right-icon" class="custom-arrow">›</view>
        </t-cell>
      </t-cell-group>
    </view>

    <!-- 关于 -->
    <view class="settings-section">
      <view class="section-title">关于</view>
      <t-cell-group>
        <t-cell title="关于资信猫" bind:click="onAbout">
          <view slot="right-icon" class="custom-arrow">›</view>
        </t-cell>
        <t-cell title="用户协议" bind:click="onUserAgreement">
          <view slot="right-icon" class="custom-arrow">›</view>
        </t-cell>
        <t-cell title="隐私政策" bind:click="onPrivacyPolicy">
          <view slot="right-icon" class="custom-arrow">›</view>
        </t-cell>
      </t-cell-group>
    </view>

    <!-- 版本信息 -->
    <view class="version-info">
      <view class="version-text">资信猫 v1.0.0</view>
      <view class="copyright">© 2023 资信猫团队</view>
    </view>
  </view>

  <!-- 组织选择弹窗 -->
  <t-popup visible="{{showOrgPicker}}" placement="bottom" bind:visible-change="onOrgPickerClose">
    <view class="picker-popup">
      <view class="picker-header">
        <view class="picker-cancel" bind:tap="onOrgPickerClose">取消</view>
        <view class="picker-title">选择组织</view>
        <view class="picker-confirm" bind:tap="onOrgConfirm">确定</view>
      </view>
      <picker-view class="picker-view" value="{{orgPickerValue}}" bind:change="onOrgPickerChange">
        <picker-view-column>
          <view wx:for="{{organizations}}" wx:key="id" class="picker-item">
            {{item.name}}
          </view>
        </picker-view-column>
      </picker-view>
    </view>
  </t-popup>

  <!-- 城市选择弹窗 -->
  <t-popup visible="{{showCityPicker}}" placement="bottom" bind:visible-change="onCityPickerClose">
    <view class="picker-popup">
      <view class="picker-header">
        <view class="picker-cancel" bind:tap="onCityPickerClose">取消</view>
        <view class="picker-title">选择城市</view>
        <view class="picker-confirm" bind:tap="onCityConfirm">确定</view>
      </view>
      <picker-view class="picker-view" value="{{cityPickerValue}}" bind:change="onCityPickerChange">
        <picker-view-column>
          <view wx:for="{{cities}}" wx:key="id" class="picker-item">
            {{item.name}}
          </view>
        </picker-view-column>
      </picker-view>
    </view>
  </t-popup>
</view>
