<!--liushui.wxml-->
<view class="container">
  <!-- æ ‡ç­¾å¯¼èˆª -->
  <view class="tabs">
    <view class="tab active">æµæ°´å®</view>
    <view class="tab" bind:tap="navigateToJianxin">ç®€ä¿¡å®</view>
    <view class="tab" bind:tap="navigateToZhuanxin">ä¸“ä¿¡å®</view>
  </view>

  <!-- ä¸Šä¼ åŒºåŸŸ -->
  <view class="card upload-card">
    <view wx:if="{{!selectedFile}}" class="upload-area" bind:tap="onChooseFile">
      <view class="upload-icon">â˜ï¸</view>
      <view class="upload-text">æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶è‡³æ­¤å¤„</view>
      <view class="upload-desc">æ”¯æŒ PDF/JPEG/PNGï¼Œæœ€å¤§ 10MB</view>
      <t-button theme="primary" size="medium" style="margin-top: 20rpx;">
        é€‰æ‹©æ–‡ä»¶
      </t-button>
    </view>

    <!-- å·²é€‰æ‹©æ–‡ä»¶ -->
    <view wx:else class="selected-file">
      <view class="file-info">
        <view class="file-icon">ğŸ“„</view>
        <view class="file-details">
          <view class="file-name">{{selectedFile.name}}</view>
          <view class="file-size">{{selectedFile.size}} å­—èŠ‚</view>
        </view>
        <view class="file-actions">
          <view class="remove-btn" bind:tap="onRemoveFile">âœ•</view>
        </view>
      </view>
    </view>

    <!-- ä¸Šä¼ è¿›åº¦ -->
    <view wx:if="{{uploading}}" class="progress-section">
      <view class="progress-text">ä¸Šä¼ ä¸­... {{uploadProgress}}%</view>
      <t-progress percentage="{{uploadProgress}}" theme="primary" />
    </view>

    <!-- åˆ†æè¿›åº¦ -->
    <view wx:if="{{generating}}" class="progress-section">
      <view class="progress-text">{{reportStatus}} {{reportProgress}}%</view>
      <t-progress percentage="{{reportProgress}}" theme="primary" />
    </view>

    <!-- å¼€å§‹åˆ†ææŒ‰é’® -->
    <view wx:if="{{selectedFile && !uploading && !generating}}" class="action-section">
      <t-button 
        theme="primary" 
        size="large" 
        block
        bind:tap="onStartAnalysis"
      >
        å¼€å§‹åˆ†æ
      </t-button>
    </view>
  </view>

  <!-- å†å²æŠ¥å‘Š -->
  <view class="card history-card">
    <view class="card-header">
      <view class="card-title">å†å²æŠ¥å‘Š</view>
      <view class="date-filter">
        <picker 
          mode="selector" 
          range="{{dateOptions}}" 
          range-key="label"
          value="{{dateRange}}"
          bind:change="onDateRangeChange"
        >
          <view class="filter-text">æ›´æ—© â–¼</view>
        </picker>
      </view>
    </view>

    <!-- æŠ¥å‘Šåˆ—è¡¨ -->
    <view wx:if="{{reportList.length > 0}}" class="report-list">
      <view 
        wx:for="{{reportList}}" 
        wx:key="id"
        class="report-item"
        data-report="{{item}}"
        bind:tap="onViewReport"
      >
        <view class="report-icon">ğŸ§¾</view>
        <view class="report-info">
          <view class="report-title">{{item.title}}</view>
          <view class="report-date">{{item.date}}</view>
        </view>
        <view class="report-arrow">â†’</view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:else class="empty-state">
      <view class="empty-icon">ğŸ“‹</view>
      <view class="empty-text">æš‚æ— å†å²æŠ¥å‘Š</view>
    </view>
  </view>
</view>
