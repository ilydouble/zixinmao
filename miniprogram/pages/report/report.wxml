<!--report.wxml - 严格按照可视化最新样版.html格式-->
<view class="container">
  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-text">加载报告中...</view>
  </view>

  <!-- 报告内容 -->
  <view wx:else class="dashboard">
    <!-- Header - 渐变背景头部 -->
    <view class="header">
      <view class="header-title">{{reportData.personalInfo.name}}个人征信分析报告</view>
      <view class="report-info-header">
        <view>报告时间: {{reportDate}}</view>
        <view>报告编号: {{reportId}}</view>
      </view>
    </view>

    <!-- 个人信息概览 -->
    <view class="personal-card">
      <view class="card-title">
        <text class="icon-user">👤</text>
        个人信息概览
      </view>
      <view class="info-grid">
        <view class="info-item">
          <view class="info-label">用户姓名</view>
          <view class="info-value">{{reportData.personalInfo.name}}</view>
        </view>
        <view class="info-item">
          <view class="info-label">年龄</view>
          <view class="info-value">{{reportData.personalInfo.age}}</view>
        </view>
        <view class="info-item">
          <view class="info-label">婚姻状况</view>
          <view class="info-value">{{reportData.personalInfo.maritalStatus}}</view>
        </view>
        <view class="info-item">
          <view class="info-label">单位性质</view>
          <view class="info-value">{{reportData.personalInfo.companyType}}</view>
        </view>
        <view class="info-item">
          <view class="info-label">工作时长</view>
          <view class="info-value">{{reportData.personalInfo.workYears}}</view>
        </view>
        <view class="info-item">
          <view class="info-label">公积金基数</view>
          <view class="info-value">{{reportData.personalInfo.fundBase}}</view>
        </view>
        <view class="info-item">
          <view class="info-label">白名单客群</view>
          <view class="info-value">{{reportData.personalInfo.whiteList}}</view>
        </view>
        <view class="info-item">
          <view class="info-label">身份证号</view>
          <view class="info-value">{{reportData.personalInfo.idCard}}</view>
        </view>
      </view>
    </view>

    <!-- 统计数据卡片 -->
    <view class="stats-grid">
      <view class="stat-card">
        <view class="stat-icon icon-credit">💳</view>
        <view class="stat-label">总授信</view>
        <view class="stat-value">{{reportData.statistics.totalCredit}}<text class="stat-unit">元</text></view>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-debt">💰</view>
        <view class="stat-label">总负债</view>
        <view class="stat-value">{{reportData.statistics.totalDebt}}<text class="stat-unit">元</text></view>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-institution">🏦</view>
        <view class="stat-label">银行机构数</view>
        <view class="stat-value">{{reportData.statistics.bankCount}}<text class="stat-unit">家</text></view>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-nonbank">🏢</view>
        <view class="stat-label">非银机构数</view>
        <view class="stat-value">{{reportData.statistics.nonBankCount}}<text class="stat-unit">家</text></view>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-overdue">⚠️</view>
        <view class="stat-label">逾期金额</view>
        <view class="stat-value">{{reportData.statistics.overdueAmount}}<text class="stat-unit">元</text></view>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-query">🔍</view>
        <view class="stat-label">查询次数</view>
        <view class="stat-value">{{reportData.statistics.queryCount}}<text class="stat-unit">次</text></view>
      </view>
    </view>

    <!-- 银行贷款列表 -->
    <view wx:if="{{reportData.bankLoans && reportData.bankLoans.length > 0}}">
      <view class="section-title">🏦 银行贷款明细</view>
      <view class="data-table-container">
        <scroll-view scroll-x class="data-table">
          <view class="table-wrapper">
            <view class="table-header">
              <view class="table-cell">机构名称</view>
              <view class="table-cell">贷款金额</view>
              <view class="table-cell">剩余金额</view>
              <view class="table-cell">发放日期</view>
              <view class="table-cell">状态</view>
            </view>
            <view wx:for="{{reportData.bankLoans}}" wx:key="index" class="table-row">
              <view class="table-cell">{{item.institutionName}}</view>
              <view class="table-cell highlight">¥{{item.loanAmount}}</view>
              <view class="table-cell">¥{{item.remainingAmount}}</view>
              <view class="table-cell">{{item.issueDate}}</view>
              <view class="table-cell {{item.status === '正常' ? 'good' : 'warning'}}">{{item.status}}</view>
            </view>
          </view>
        </scroll-view>
      </view>
    </view>

    <!-- 非银贷款列表 -->
    <view wx:if="{{reportData.nonBankLoans && reportData.nonBankLoans.length > 0}}">
      <view class="section-title">🏢 非银贷款明细</view>
      <view class="data-table-container">
        <scroll-view scroll-x class="data-table">
          <view class="table-wrapper">
            <view class="table-header">
              <view class="table-cell">机构名称</view>
              <view class="table-cell">贷款金额</view>
              <view class="table-cell">剩余金额</view>
              <view class="table-cell">状态</view>
            </view>
            <view wx:for="{{reportData.nonBankLoans}}" wx:key="index" class="table-row">
              <view class="table-cell">{{item.institutionName}}</view>
              <view class="table-cell highlight">¥{{item.loanAmount}}</view>
              <view class="table-cell">¥{{item.remainingAmount}}</view>
              <view class="table-cell {{item.status === '正常' ? 'good' : 'warning'}}">{{item.status}}</view>
            </view>
          </view>
        </scroll-view>
      </view>
    </view>

    <!-- 信用卡列表 -->
    <view wx:if="{{reportData.creditCards && reportData.creditCards.length > 0}}">
      <view class="section-title">💳 信用卡明细</view>
      <view class="data-table-container">
        <scroll-view scroll-x class="data-table">
          <view class="table-wrapper">
            <view class="table-header">
              <view class="table-cell">发卡机构</view>
              <view class="table-cell">信用额度</view>
              <view class="table-cell">已用额度</view>
              <view class="table-cell">开卡日期</view>
              <view class="table-cell">状态</view>
            </view>
            <view wx:for="{{reportData.creditCards}}" wx:key="index" class="table-row">
              <view class="table-cell">{{item.issuer}}</view>
              <view class="table-cell highlight">¥{{item.creditLimit}}</view>
              <view class="table-cell">¥{{item.usedAmount}}</view>
              <view class="table-cell">{{item.issueDate}}</view>
              <view class="table-cell {{item.status === '正常' ? 'good' : 'warning'}}">{{item.status}}</view>
            </view>
          </view>
        </scroll-view>
      </view>
    </view>

    <!-- AI智能分析 -->
    <view wx:if="{{reportData.aiAnalysis}}" class="analysis-section">
      <view class="analysis-title">🤖 AI智能分析</view>
      <view class="analysis-content">
        <view class="ai-analysis-grid">
          <view wx:for="{{reportData.aiAnalysisPoints}}" wx:key="index" class="ai-analysis-item">
            <view class="ai-analysis-number">{{index + 1}}</view>
            <view class="ai-analysis-text">{{item}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- 风险提示 -->
    <view wx:if="{{reportData.riskFactors && reportData.riskFactors.length > 0}}" class="analysis-section">
      <view class="analysis-title">⚠️ 风险提示</view>
      <view class="analysis-content">
        <view wx:for="{{reportData.riskFactors}}" wx:key="index" class="analysis-point">
          {{item}}
        </view>
      </view>
    </view>

    <!-- 专业建议 -->
    <view wx:if="{{reportData.suggestions && reportData.suggestions.length > 0}}" class="analysis-section">
      <view class="analysis-title">💡 专业建议</view>
      <view class="analysis-content">
        <view wx:for="{{reportData.suggestions}}" wx:key="index" class="analysis-point">
          {{item}}
        </view>
      </view>
    </view>

    <!-- 免责声明 -->
    <view class="disclaimer">
      <view class="disclaimer-title">免责声明</view>
      <view class="disclaimer-content">
        本报告仅供参考，不构成任何投资建议或信用评估依据。报告内容基于AI分析生成，可能存在误差。具体信用状况请以中国人民银行征信中心出具的官方征信报告为准。
      </view>
    </view>

    <!-- 操作按钮区域 -->
    <view class="action-buttons">
      <button class="action-btn download-btn" bindtap="onDownloadReport">
        <text class="btn-icon">📥</text>
        <text class="btn-text">下载报告</text>
      </button>
      <button class="action-btn share-btn" open-type="share">
        <text class="btn-icon">📤</text>
        <text class="btn-text">分享报告</text>
      </button>
    </view>
  </view>
</view>

