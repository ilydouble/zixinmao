<!--report.wxml-->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-text">åŠ è½½æŠ¥å‘Šä¸­...</view>
  </view>

  <!-- æŠ¥å‘Šå†…å®¹ -->
  <view wx:else class="report-content">
    <!-- æŠ¥å‘Šå¤´éƒ¨ -->
    <view class="report-header">
      <view class="report-title">{{reportTitle}}</view>
      <view class="report-date">ç”Ÿæˆæ—¶é—´ï¼š{{reportDate}}</view>
      <view class="report-actions">
        <t-button 
          theme="light" 
          size="small" 
          bind:tap="onDownloadReport"
        >
          ğŸ“¥ ä¸‹è½½
        </t-button>
        <t-button 
          theme="light" 
          size="small" 
          loading="{{sharing}}"
          bind:tap="onShareReport"
        >
          ğŸ“¤ åˆ†äº«
        </t-button>
      </view>
    </view>

    <!-- ç»¼åˆè¯„åˆ† -->
    <view class="score-section">
      <view class="score-card">
        <view class="score-number">{{reportData.summary.score}}</view>
        <view class="score-label">ç»¼åˆè¯„åˆ†</view>
        <view class="score-level">{{reportData.summary.level}}</view>
      </view>
      <view class="risk-info">
        <view class="risk-level">é£é™©ç­‰çº§ï¼š{{reportData.summary.riskLevel}}</view>
      </view>
    </view>

    <!-- æµæ°´å®æŠ¥å‘Šå†…å®¹ -->
    <block wx:if="{{reportType === 'liushui'}}">
      <view class="analysis-section">
        <view class="section-title">ğŸ’° æµæ°´åˆ†æ</view>
        <view class="analysis-grid">
          <view class="analysis-item">
            <view class="item-label">æ€»æ”¶å…¥</view>
            <view class="item-value">{{reportData.flowAnalysis.totalIncome}}</view>
          </view>
          <view class="analysis-item">
            <view class="item-label">æ€»æ”¯å‡º</view>
            <view class="item-value">{{reportData.flowAnalysis.totalExpense}}</view>
          </view>
          <view class="analysis-item">
            <view class="item-label">æœˆå‡æ”¶å…¥</view>
            <view class="item-value">{{reportData.flowAnalysis.avgMonthlyIncome}}</view>
          </view>
          <view class="analysis-item">
            <view class="item-label">æœˆå‡æ”¯å‡º</view>
            <view class="item-value">{{reportData.flowAnalysis.avgMonthlyExpense}}</view>
          </view>
        </view>
        
        <view class="stability-info">
          <view class="stability-item">
            <text class="label">æ”¶å…¥ç¨³å®šæ€§ï¼š</text>
            <text class="value">{{reportData.flowAnalysis.incomeStability}}</text>
          </view>
          <view class="stability-item">
            <text class="label">æ”¯å‡ºè§„å¾‹æ€§ï¼š</text>
            <text class="value">{{reportData.flowAnalysis.expensePattern}}</text>
          </view>
        </view>
      </view>
    </block>

    <!-- ç®€ä¿¡å®æŠ¥å‘Šå†…å®¹ -->
    <block wx:if="{{reportType === 'jianxin'}}">
      <view class="analysis-section">
        <view class="section-title">ğŸ’³ ä¿¡ç”¨å¡ä¿¡æ¯</view>
        <view class="credit-info">
          <view class="info-row">
            <text class="label">ä¿¡ç”¨å¡æ•°é‡ï¼š</text>
            <text class="value">{{reportData.creditInfo.creditCards}}å¼ </text>
          </view>
          <view class="info-row">
            <text class="label">æ€»æˆä¿¡é¢åº¦ï¼š</text>
            <text class="value">{{reportData.creditInfo.totalCreditLimit}}</text>
          </view>
          <view class="info-row">
            <text class="label">å·²ç”¨é¢åº¦ï¼š</text>
            <text class="value">{{reportData.creditInfo.usedCredit}}</text>
          </view>
          <view class="info-row">
            <text class="label">ä½¿ç”¨ç‡ï¼š</text>
            <text class="value">{{reportData.creditInfo.utilizationRate}}</text>
          </view>
        </view>
      </view>

      <view class="analysis-section">
        <view class="section-title">ğŸ¦ è´·æ¬¾ä¿¡æ¯</view>
        <view class="loan-info">
          <view class="info-row">
            <text class="label">åœ¨è´·ç¬”æ•°ï¼š</text>
            <text class="value">{{reportData.loanInfo.activeLoan}}ç¬”</text>
          </view>
          <view class="info-row">
            <text class="label">è´·æ¬¾æ€»é¢ï¼š</text>
            <text class="value">{{reportData.loanInfo.totalLoanAmount}}</text>
          </view>
          <view class="info-row">
            <text class="label">æœˆä¾›é‡‘é¢ï¼š</text>
            <text class="value">{{reportData.loanInfo.monthlyPayment}}</text>
          </view>
          <view class="info-row">
            <text class="label">è¿˜æ¬¾çŠ¶æ€ï¼š</text>
            <text class="value success">{{reportData.loanInfo.paymentHistory}}</text>
          </view>
        </view>
      </view>
    </block>

    <!-- ä¸“ä¿¡å®æŠ¥å‘Šå†…å®¹ -->
    <block wx:if="{{reportType === 'zhuanxin'}}">
      <view class="analysis-section">
        <view class="section-title">ğŸ“Š è¯¦ç»†åˆ†æ</view>
        <view class="detailed-info">
          <view class="info-row">
            <text class="label">ä¿¡ç”¨å†å²ï¼š</text>
            <text class="value">{{reportData.detailedAnalysis.creditHistory}}</text>
          </view>
          <view class="info-row">
            <text class="label">è´¦æˆ·ç±»å‹ï¼š</text>
            <text class="value">{{reportData.detailedAnalysis.accountTypes}}</text>
          </view>
        </view>
        
        <view class="query-section">
          <view class="subsection-title">æŸ¥è¯¢è®°å½•</view>
          <view class="query-info">
            <view class="query-item">
              <text class="label">è¿‘6ä¸ªæœˆï¼š</text>
              <text class="value">{{reportData.detailedAnalysis.queryRecords.recent6Months}}æ¬¡</text>
            </view>
            <view class="query-item">
              <text class="label">è¿‘2å¹´ï¼š</text>
              <text class="value">{{reportData.detailedAnalysis.queryRecords.recent2Years}}æ¬¡</text>
            </view>
          </view>
        </view>

        <view class="risk-assessment">
          <view class="subsection-title">é£é™©è¯„ä¼°</view>
          <view class="risk-grid">
            <view class="risk-item">
              <view class="risk-label">æ•´ä½“é£é™©</view>
              <view class="risk-value low">{{reportData.riskAssessment.overallRisk}}</view>
            </view>
            <view class="risk-item">
              <view class="risk-label">ä¿¡ç”¨é£é™©</view>
              <view class="risk-value low">{{reportData.riskAssessment.creditRisk}}</view>
            </view>
            <view class="risk-item">
              <view class="risk-label">è¿˜æ¬¾é£é™©</view>
              <view class="risk-value low">{{reportData.riskAssessment.repaymentRisk}}</view>
            </view>
            <view class="risk-item">
              <view class="risk-label">ç¨³å®šæ€§é£é™©</view>
              <view class="risk-value medium">{{reportData.riskAssessment.stabilityRisk}}</view>
            </view>
          </view>
        </view>
      </view>
    </block>

    <!-- é£é™©æç¤º -->
    <view wx:if="{{reportData.riskPoints}}" class="risk-section">
      <view class="section-title">âš ï¸ é£é™©æç¤º</view>
      <view class="risk-list">
        <view 
          wx:for="{{reportData.riskPoints}}" 
          wx:key="index"
          class="risk-item-text"
        >
          â€¢ {{item}}
        </view>
      </view>
    </view>

    <!-- å»ºè®® -->
    <view wx:if="{{reportData.suggestions || reportData.professionalAdvice}}" class="suggestion-section">
      <view class="section-title">ğŸ’¡ ä¸“ä¸šå»ºè®®</view>
      <view class="suggestion-list">
        <view 
          wx:for="{{reportData.suggestions || reportData.professionalAdvice}}" 
          wx:key="index"
          class="suggestion-item"
        >
          {{index + 1}}. {{item}}
        </view>
      </view>
    </view>

    <!-- å…è´£å£°æ˜ -->
    <view class="disclaimer">
      <view class="disclaimer-title">å…è´£å£°æ˜</view>
      <view class="disclaimer-text">
        æœ¬æŠ¥å‘Šä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆä»»ä½•æŠ•èµ„å»ºè®®ã€‚æŠ¥å‘Šå†…å®¹åŸºäºæä¾›çš„æ•°æ®è¿›è¡Œåˆ†æï¼Œå®é™…æƒ…å†µå¯èƒ½å­˜åœ¨å·®å¼‚ã€‚ä½¿ç”¨æœ¬æŠ¥å‘Šäº§ç”Ÿçš„ä»»ä½•åæœï¼Œæœ¬å¹³å°ä¸æ‰¿æ‹…è´£ä»»ã€‚
      </view>
    </view>
  </view>
</view>
