<!-- miniprogram/pages/report-native/report-native.wxml -->
<view class="report-container">
  <!-- åŠ è½½ä¸­ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½æŠ¥å‘Šä¸­...</text>
  </view>

  <!-- é”™è¯¯æç¤º -->
  <view wx:elif="{{error}}" class="error-container">
    <text class="error-icon">âš ï¸</text>
    <text class="error-text">{{error}}</text>
    <button class="retry-button" bindtap="loadReportData">é‡è¯•</button>
  </view>

  <!-- æŠ¥å‘Šå†…å®¹ -->
  <view wx:else class="report-content">
    <!-- å¤´éƒ¨ -->
    <view class="report-header">
      <text class="report-title">{{personalInfo.name}}ä¸ªäººå¾ä¿¡åˆ†ææŠ¥å‘Š</text>
      <text class="report-subtitle">æŠ¥å‘Šæ—¶é—´: {{reportData.report_date}}</text>
      <text class="report-subtitle">æŠ¥å‘Šç¼–å·: {{reportData.report_number}}</text>
    </view>


    <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
    <view class="section personal-section">
      <view class="section-title">
        <text class="title-icon">ğŸ‘¤</text>
        <text class="title-text">ä¸ªäººä¿¡æ¯</text>
      </view>
      <view class="info-grid">
        <view class="info-item">
          <text class="info-label">å§“å</text>
          <text class="info-value">{{personalInfo.name}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">å¹´é¾„</text>
          <text class="info-value">{{personalInfo.age}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">å©šå§»çŠ¶å†µ</text>
          <text class="info-value">{{personalInfo.marital_status}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">èº«ä»½è¯å·</text>
          <text class="info-value">{{personalInfo.id_card}}</text>
        </view>
      </view>
    </view>

    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <view class="stats-grid">
      <view class="stat-card">
        <view class="stat-icon icon-credit">ğŸ’°</view>
        <text class="stat-label">æ€»æˆä¿¡é¢åº¦</text>
        <text class="stat-value">{{stats.total_credit}}<text class="stat-unit">å…ƒ</text></text>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-debt">ğŸ“Š</view>
        <text class="stat-label">æ€»è´Ÿå€ºé‡‘é¢</text>
        <text class="stat-value">{{stats.total_debt}}<text class="stat-unit">å…ƒ</text></text>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-institution">ğŸ¦</view>
        <text class="stat-label">æ€»æœºæ„æ•°</text>
        <text class="stat-value">{{stats.total_institutions}}<text class="stat-unit">ä¸ª</text></text>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-loan">ğŸ¢</view>
        <text class="stat-label">è´·æ¬¾æœºæ„æ•°</text>
        <text class="stat-value">{{stats.loan_institutions}}<text class="stat-unit">ä¸ª</text></text>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-overdue">âš ï¸</view>
        <text class="stat-label">å†å²é€¾æœŸæœˆä»½</text>
        <text class="stat-value">{{stats.overdue_months}}<text class="stat-unit">æœˆ</text></text>
      </view>
      <view class="stat-card">
        <view class="stat-icon icon-query">ğŸ”</view>
        <text class="stat-label">è¿‘3æœˆæŸ¥è¯¢æ¬¡æ•°</text>
        <text class="stat-value">{{stats.query_count_3m}}<text class="stat-unit">æ¬¡</text></text>
      </view>
    </view>

    <!-- è´Ÿå€ºæ„æˆ -->
    <view class="section">
      <view class="section-title">
        <text class="title-icon">ğŸ“ˆ</text>
        <text class="title-text">è´Ÿå€ºæ„æˆåˆ†æ</text>
      </view>
      <view class="debt-list">
        <view wx:for="{{debtComposition}}" wx:key="type" class="debt-item">
          <view class="debt-header">
            <text class="debt-type">{{item.type}}</text>
            <text class="debt-usage" wx:if="{{item.usage_rate}}">ä½¿ç”¨ç‡: {{item.usage_rate}}</text>
          </view>
          <view class="debt-stats">
            <view class="debt-stat">
              <text class="debt-stat-label">æœºæ„æ•°</text>
              <text class="debt-stat-value">{{item.institutions}}ä¸ª</text>
            </view>
            <view class="debt-stat">
              <text class="debt-stat-label">è´¦æˆ·æ•°</text>
              <text class="debt-stat-value">{{item.accounts}}ä¸ª</text>
            </view>
            <view class="debt-stat">
              <text class="debt-stat-label">æˆä¿¡é¢åº¦</text>
              <text class="debt-stat-value">{{item.credit_limit}}å…ƒ</text>
            </view>
            <view class="debt-stat">
              <text class="debt-stat-label">ä½™é¢</text>
              <text class="debt-stat-value">{{item.balance}}å…ƒ</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- è´·æ¬¾è¯¦æƒ… -->
    <view class="section">
      <view class="section-title">
        <text class="title-icon">ğŸ¦</text>
        <text class="title-text">è´·æ¬¾è¯¦æƒ…</text>
      </view>
      
      <!-- è´·æ¬¾æ±‡æ€» -->
      <view class="loan-summary">
        <view class="summary-item">
          <text class="summary-label">å¹³å‡æœŸé™</text>
          <text class="summary-value">{{loanSummary.avg_period}}</text>
        </view>
        <view class="summary-item">
          <text class="summary-label">æœ€é«˜å•ç¬”</text>
          <text class="summary-value">{{loanSummary.max_balance}}å…ƒ</text>
        </view>
        <view class="summary-item">
          <text class="summary-label">æœ€å°å•ç¬”</text>
          <text class="summary-value">{{loanSummary.min_balance}}å…ƒ</text>
        </view>
        <view class="summary-item">
          <text class="summary-label">æœºæ„ç±»å‹</text>
          <text class="summary-value">{{loanSummary.institution_types}}</text>
        </view>
      </view>

      <!-- é“¶è¡Œè´·æ¬¾ -->
      <view wx:if="{{bankLoans.length > 0}}" class="loan-category">
        <text class="category-title">é“¶è¡Œè´·æ¬¾</text>
        <view class="table-container">
          <scroll-view scroll-x="true" class="table-scroll">
            <view class="loan-table">
              <view class="table-header">
                <text class="table-cell">åºå·</text>
                <text class="table-cell">ç®¡ç†æœºæ„</text>
                <text class="table-cell">æˆä¿¡é¢åº¦</text>
                <text class="table-cell">ä½™é¢</text>
                <text class="table-cell">ä¸šåŠ¡ç±»å‹</text>
                <text class="table-cell">èµ·æ­¢æ—¥æœŸ</text>
                <text class="table-cell">å‰©ä½™æœŸé™</text>
                <text class="table-cell">ä½¿ç”¨ç‡</text>
              </view>
              <view wx:for="{{bankLoans}}" wx:key="id" class="table-row">
                <text class="table-cell">{{item.id}}</text>
                <text class="table-cell">{{item.institution}}</text>
                <text class="table-cell">{{item.credit_limit}}</text>
                <text class="table-cell">{{item.balance}}</text>
                <text class="table-cell">{{item.business_type}}</text>
                <text class="table-cell">{{item.period}}</text>
                <text class="table-cell">{{item.remaining_period}}</text>
                <text class="table-cell">{{item.usage_rate}}</text>
              </view>
              <!-- é“¶è¡Œåˆè®¡ -->
              <view class="table-row table-total">
                <text class="table-cell total-label">é“¶è¡Œåˆè®¡</text>
                <text class="table-cell">-</text>
                <text class="table-cell total-value">{{bankLoanTotal.creditLimit}}</text>
                <text class="table-cell total-value">{{bankLoanTotal.balance}}</text>
                <text class="table-cell">-</text>
                <text class="table-cell">-</text>
                <text class="table-cell">-</text>
                <text class="table-cell total-value">{{bankLoanTotal.usageRate}}%</text>
              </view>
            </view>
          </scroll-view>
        </view>
      </view>

      <!-- éé“¶æœºæ„è´·æ¬¾ -->
      <view wx:if="{{nonBankLoans.length > 0}}" class="loan-category">
        <text class="category-title">éé“¶æœºæ„è´·æ¬¾</text>
        <view class="table-container">
          <scroll-view scroll-x="true" class="table-scroll">
            <view class="loan-table">
              <view class="table-header">
                <text class="table-cell">åºå·</text>
                <text class="table-cell">ç®¡ç†æœºæ„</text>
                <text class="table-cell">æˆä¿¡é¢åº¦</text>
                <text class="table-cell">ä½™é¢</text>
                <text class="table-cell">ä¸šåŠ¡ç±»å‹</text>
                <text class="table-cell">èµ·æ­¢æ—¥æœŸ</text>
                <text class="table-cell">å‰©ä½™æœŸé™</text>
                <text class="table-cell">ä½¿ç”¨ç‡</text>
              </view>
              <view wx:for="{{nonBankLoans}}" wx:key="id" class="table-row">
                <text class="table-cell">{{item.id}}</text>
                <text class="table-cell">{{item.institution}}</text>
                <text class="table-cell">{{item.credit_limit}}</text>
                <text class="table-cell">{{item.balance}}</text>
                <text class="table-cell">{{item.business_type}}</text>
                <text class="table-cell">{{item.period}}</text>
                <text class="table-cell">{{item.remaining_period}}</text>
                <text class="table-cell">{{item.usage_rate}}</text>
              </view>
              <!-- éé“¶æœºæ„åˆè®¡ -->
              <view class="table-row table-total">
                <text class="table-cell total-label">éé“¶æœºæ„åˆè®¡</text>
                <text class="table-cell">-</text>
                <text class="table-cell total-value">{{nonBankLoanTotal.creditLimit}}</text>
                <text class="table-cell total-value">{{nonBankLoanTotal.balance}}</text>
                <text class="table-cell">-</text>
                <text class="table-cell">-</text>
                <text class="table-cell">-</text>
                <text class="table-cell total-value">{{nonBankLoanTotal.usageRate}}%</text>
              </view>
              <!-- æ€»åˆè®¡ -->
              <view class="table-row table-grand-total">
                <text class="table-cell grand-total-label">åˆè®¡</text>
                <text class="table-cell">-</text>
                <text class="table-cell grand-total-value">{{grandLoanTotal.creditLimit}}</text>
                <text class="table-cell grand-total-value">{{grandLoanTotal.balance}}</text>
                <text class="table-cell">-</text>
                <text class="table-cell">-</text>
                <text class="table-cell">-</text>
                <text class="table-cell grand-total-value">{{grandLoanTotal.usageRate}}%</text>
              </view>
            </view>
          </scroll-view>
        </view>
      </view>
    </view>

    <!-- ä¿¡ç”¨å¡ä½¿ç”¨æƒ…å†µ -->
    <view class="section">
      <view class="section-title">
        <text class="title-icon">ğŸ’³</text>
        <text class="title-text">ä¿¡ç”¨å¡ä½¿ç”¨æƒ…å†µ</text>
      </view>
      
      <!-- ä½¿ç”¨ç‡åˆ†æ -->
      <view class="credit-usage-card">
        <view class="usage-header">
          <text class="usage-title">ä½¿ç”¨ç‡åˆ†æ</text>
          <text class="usage-percentage">{{creditUsage.usage_percentage}}%</text>
        </view>
        <view class="usage-progress">
          <view class="progress-bar" style="width: {{creditUsage.usage_percentage}}%;"></view>
        </view>
        <view class="usage-info">
          <view class="usage-item">
            <text class="usage-label">é£é™©ç­‰çº§</text>
            <text class="usage-value {{creditUsage.risk_level == 'ä½' ? 'risk-low' : (creditUsage.risk_level == 'ä¸­' ? 'risk-medium' : 'risk-high')}}">{{creditUsage.risk_level}}</text>
          </view>
          <view class="usage-item">
            <text class="usage-label">å½±å“ç¨‹åº¦</text>
            <text class="usage-value">{{creditUsage.impact_level}}</text>
          </view>
        </view>
        <view class="usage-amounts">
          <view class="amount-item">
            <text class="amount-label">æˆä¿¡é¢åº¦</text>
            <text class="amount-value">{{creditUsage.total_credit}}å…ƒ</text>
          </view>
          <view class="amount-item">
            <text class="amount-label">å·²ç”¨é¢åº¦</text>
            <text class="amount-value">{{creditUsage.used_credit}}å…ƒ</text>
          </view>
          <view class="amount-item">
            <text class="amount-label">å¯ç”¨é¢åº¦</text>
            <text class="amount-value">{{creditUsage.available_credit}}å…ƒ</text>
          </view>
        </view>
      </view>

      <!-- ä¿¡ç”¨å¡æ˜ç»† -->
      <view wx:if="{{creditCards.length > 0}}" class="credit-cards-list">
        <text class="list-title">ä¿¡ç”¨å¡æ˜ç»†</text>
        <view class="table-container">
          <scroll-view scroll-x="true" class="table-scroll">
            <view class="credit-table">
              <view class="table-header">
                <text class="table-cell">åºå·</text>
                <text class="table-cell">ç®¡ç†æœºæ„</text>
                <text class="table-cell">æˆä¿¡é¢åº¦</text>
                <text class="table-cell">å·²ç”¨é¢åº¦</text>
                <text class="table-cell">åˆ†æœŸä½™é¢</text>
                <text class="table-cell">ä½¿ç”¨ç‡</text>
                <text class="table-cell">å½“å‰çŠ¶æ€</text>
                <text class="table-cell">å†å²é€¾æœŸ</text>
              </view>
              <view wx:for="{{creditCards}}" wx:key="id" class="table-row">
                <text class="table-cell">{{item.id}}</text>
                <text class="table-cell">{{item.institution}}</text>
                <text class="table-cell">{{item.credit_limit}}</text>
                <text class="table-cell">{{item.used_amount}}</text>
                <text class="table-cell">{{item.installment_balance}}</text>
                <text class="table-cell">{{item.usage_rate}}</text>
                <text class="table-cell">{{item.status}}</text>
                <text class="table-cell">{{item.overdue_history}}</text>
              </view>
              <!-- ä¿¡ç”¨å¡åˆè®¡ -->
              <view class="table-row table-grand-total">
                <text class="table-cell grand-total-label">åˆè®¡</text>
                <text class="table-cell">-</text>
                <text class="table-cell grand-total-value">{{creditCardTotal.creditLimit}}</text>
                <text class="table-cell grand-total-value">{{creditCardTotal.usedAmount}}</text>
                <text class="table-cell grand-total-value">{{creditCardTotal.installmentBalance}}</text>
                <text class="table-cell grand-total-value">{{creditCardTotal.usageRate}}%</text>
                <text class="table-cell">-</text>
                <text class="table-cell">-</text>
              </view>
            </view>
          </scroll-view>
        </view>
      </view>
    </view>

    <!-- é€¾æœŸæƒ…å†µåˆ†æ -->
    <view class="section">
      <view class="section-title">
        <text class="title-icon">âš ï¸</text>
        <text class="title-text">é€¾æœŸæƒ…å†µåˆ†æ</text>
      </view>

      <view class="overdue-severity">
        <view class="severity-header">
          <text class="severity-title">ä¸¥é‡ç¨‹åº¦</text>
          <text class="severity-level">{{overdueAnalysis.severity_level}}</text>
        </view>
        <view class="severity-progress">
          <view class="severity-bar" style="width: {{overdueAnalysis.severity_percentage}}%;"></view>
        </view>
        <view class="overdue-stats">
          <view class="overdue-stat">
            <text class="overdue-stat-value">{{overdueAnalysis.overdue_90plus}}</text>
            <text class="overdue-stat-label">90å¤©ä»¥ä¸Š</text>
          </view>
          <view class="overdue-stat">
            <text class="overdue-stat-value">{{overdueAnalysis.overdue_30_90}}</text>
            <text class="overdue-stat-label">30-90å¤©</text>
          </view>
          <view class="overdue-stat">
            <text class="overdue-stat-value">{{overdueAnalysis.overdue_under_30}}</text>
            <text class="overdue-stat-label">30å¤©ä»¥å†…</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æŸ¥è¯¢è®°å½•åˆ†æ -->
    <view class="section">
      <view class="section-title">
        <text class="title-icon">ğŸ”</text>
        <text class="title-text">æŸ¥è¯¢è®°å½•åˆ†æ</text>
      </view>

      <view class="query-list">
        <view wx:for="{{queryRecords}}" wx:key="period" class="query-item">
          <view class="query-period">{{item.period}}</view>
          <view class="query-details">
            <view class="query-detail" wx:if="{{item.loan_approval > 0}}">
              <text class="query-label">è´·æ¬¾å®¡æ‰¹</text>
              <text class="query-value">{{item.loan_approval}}æ¬¡</text>
            </view>
            <view class="query-detail" wx:if="{{item.credit_card_approval > 0}}">
              <text class="query-label">ä¿¡ç”¨å¡å®¡æ‰¹</text>
              <text class="query-value">{{item.credit_card_approval}}æ¬¡</text>
            </view>
            <view class="query-detail" wx:if="{{item.guarantee_review > 0}}">
              <text class="query-label">æ‹…ä¿èµ„æ ¼å®¡æŸ¥</text>
              <text class="query-value">{{item.guarantee_review}}æ¬¡</text>
            </view>
            <view class="query-detail" wx:if="{{item.insurance_review > 0}}">
              <text class="query-label">ä¿å‰å®¡æŸ¥</text>
              <text class="query-value">{{item.insurance_review}}æ¬¡</text>
            </view>
            <view class="query-detail" wx:if="{{item.credit_review > 0}}">
              <text class="query-label">èµ„ä¿¡å®¡æŸ¥</text>
              <text class="query-value">{{item.credit_review}}æ¬¡</text>
            </view>
            <view class="query-detail" wx:if="{{item.non_post_loan > 0}}">
              <text class="query-label">éè´·åç®¡ç†æŸ¥è¯¢</text>
              <text class="query-value">{{item.non_post_loan}}æ¬¡</text>
            </view>
            <view class="query-detail" wx:if="{{item.self_query > 0}}">
              <text class="query-label">æœ¬äººæŸ¥è¯¢</text>
              <text class="query-value">{{item.self_query}}æ¬¡</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- æŠ¥å‘Šæ‘˜è¦ -->
    <view class="section" wx:if="{{reportSummary}}">
      <view class="section-title">
        <text class="title-icon">ğŸ“‹</text>
        <text class="title-text">æŠ¥å‘Šæ‘˜è¦</text>
      </view>

      <!-- è§„åˆ™éªŒè¯ -->
      <view class="summary-card" wx:if="{{reportSummary.rule_validation}}">
        <view class="summary-item-header">
          <text class="summary-label">è§„åˆ™éªŒè¯</text>
          <text class="summary-value">{{reportSummary.rule_validation.result}}</text>
        </view>
        <text class="summary-detail">ç­–ç•¥: {{reportSummary.rule_validation.code}}</text>
      </view>

      <!-- åæ¬ºè¯ˆè¯„åˆ† -->
      <view class="summary-card" wx:if="{{reportSummary.anti_fraud_score}}">
        <view class="summary-item-header">
          <text class="summary-label">åæ¬ºè¯ˆè¯„åˆ†</text>
          <text class="summary-value">{{reportSummary.anti_fraud_score.level}}</text>
        </view>
      </view>

      <!-- åæ¬ºè¯ˆè§„åˆ™ -->
      <view class="summary-card" wx:if="{{reportSummary.anti_fraud_rule}}">
        <view class="summary-item-header">
          <text class="summary-label">åæ¬ºè¯ˆè§„åˆ™</text>
          <text class="summary-value">{{reportSummary.anti_fraud_rule.level}}</text>
        </view>
        <text class="summary-detail">ç­–ç•¥: {{reportSummary.anti_fraud_rule.code}}</text>
      </view>

      <!-- å¼‚å¸¸è§„åˆ™å‘½ä¸­ -->
      <view class="summary-card" wx:if="{{reportSummary.abnormal_rules_hit}}">
        <view class="summary-item-header">
          <text class="summary-label">å¼‚å¸¸è§„åˆ™å‘½ä¸­</text>
          <text class="summary-value">{{reportSummary.abnormal_rules_hit.count}}é¡¹</text>
        </view>
        <text class="summary-detail">âš ï¸ {{reportSummary.abnormal_rules_hit.alert}}</text>
      </view>
    </view>

    <!-- åŸºæœ¬ä¿¡æ¯ -->
    <view class="section" wx:if="{{basicInfo}}">
      <view class="section-title">
        <text class="title-icon">ğŸ‘¤</text>
        <text class="title-text">åŸºæœ¬ä¿¡æ¯</text>
      </view>

      <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
      <view class="info-card">
        <view class="info-row">
          <text class="info-label">å§“å</text>
          <text class="info-value">{{basicInfo.name}}</text>
        </view>
        <view class="info-row">
          <text class="info-label">æ‰‹æœºå·</text>
          <text class="info-value">{{basicInfo.phone}}</text>
        </view>
        <view class="info-row">
          <text class="info-label">èº«ä»½è¯å·</text>
          <text class="info-value">{{basicInfo.id_card}}</text>
        </view>
        <view class="info-row">
          <text class="info-label">æŠ¥å‘Šç¼–å·</text>
          <text class="info-value">{{basicInfo.report_id}}</text>
        </view>
      </view>

      <!-- æ ¸éªŒé¡¹åˆ—è¡¨ -->
      <view wx:if="{{basicInfo.verifications && basicInfo.verifications.length > 0}}" class="verification-list">
        <text class="list-title">æ ¸éªŒé¡¹ç»“æœ</text>
        <view wx:for="{{basicInfo.verifications}}" wx:key="item" class="verification-item">
          <view class="verification-header">
            <text class="verification-item-name">{{item.item}}</text>
            <text class="verification-result">{{item.result}}</text>
          </view>
          <text class="verification-description">{{item.description}}</text>
          <text class="verification-details" wx:if="{{item.details}}">{{item.details}}</text>
        </view>
      </view>
    </view>

    <!-- é£é™©è¯†åˆ« -->
    <view class="section" wx:if="{{riskIdentification}}">
      <view class="section-title">
        <text class="title-icon">âš ï¸</text>
        <text class="title-text">é£é™©è¯†åˆ«</text>
      </view>

      <!-- æ¶‰æ¡ˆå…¬å‘Š -->
      <view wx:if="{{riskIdentification.case_announcements && riskIdentification.case_announcements.records.length > 0}}" class="risk-subsection">
        <view class="risk-subsection-header">
          <text class="risk-icon">ğŸ“‹</text>
          <text class="risk-title">{{riskIdentification.case_announcements.title}}</text>
        </view>
        <view class="risk-list">
          <view wx:for="{{riskIdentification.case_announcements.records}}" wx:key="case_number" class="risk-item">
            <view class="risk-item-header">
              <text class="risk-item-label">æ³•é™¢</text>
              <text class="risk-item-value">{{item.authority}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">æ¡ˆå·</text>
              <text class="risk-item-value">{{item.case_number}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">æ¡ˆä»¶ç±»å‹</text>
              <text class="risk-item-value">{{item.case_type}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">ç«‹æ¡ˆæ—¥æœŸ</text>
              <text class="risk-item-value">{{item.filing_date}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- æ‰§è¡Œå…¬å‘Š -->
      <view wx:if="{{riskIdentification.enforcement_announcements && riskIdentification.enforcement_announcements.records.length > 0}}" class="risk-subsection">
        <view class="risk-subsection-header">
          <text class="risk-icon">âš–ï¸</text>
          <text class="risk-title">{{riskIdentification.enforcement_announcements.title}}</text>
        </view>
        <view class="risk-list">
          <view wx:for="{{riskIdentification.enforcement_announcements.records}}" wx:key="case_number" class="risk-item">
            <view class="risk-item-header">
              <text class="risk-item-label">æ³•é™¢</text>
              <text class="risk-item-value">{{item.court}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">æ¡ˆå·</text>
              <text class="risk-item-value">{{item.case_number}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">çŠ¶æ€</text>
              <text class="risk-item-value">{{item.status}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">æ‰§è¡Œæ ‡çš„</text>
              <text class="risk-item-value">{{item.target_amount}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- å¤±ä¿¡å…¬å‘Š -->
      <view wx:if="{{riskIdentification.dishonest_announcements && riskIdentification.dishonest_announcements.records.length > 0}}" class="risk-subsection">
        <view class="risk-subsection-header">
          <text class="risk-icon">âŒ</text>
          <text class="risk-title">{{riskIdentification.dishonest_announcements.title}}</text>
        </view>
        <view class="risk-list">
          <view wx:for="{{riskIdentification.dishonest_announcements.records}}" wx:key="id_card" class="risk-item">
            <view class="risk-item-header">
              <text class="risk-item-label">æ³•é™¢</text>
              <text class="risk-item-value">{{item.court}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">è¢«æ‰§è¡Œäºº</text>
              <text class="risk-item-value">{{item.dishonest_person}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">å±¥è¡Œæƒ…å†µ</text>
              <text class="risk-item-value">{{item.performance_status}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">å…¬å‘Šæ—¥æœŸ</text>
              <text class="risk-item-value">{{item.filing_date}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- é™é«˜å…¬å‘Š -->
      <view wx:if="{{riskIdentification.high_consumption_restriction_announcements && riskIdentification.high_consumption_restriction_announcements.records.length > 0}}" class="risk-subsection">
        <view class="risk-subsection-header">
          <text class="risk-icon">ğŸš«</text>
          <text class="risk-title">{{riskIdentification.high_consumption_restriction_announcements.title}}</text>
        </view>
        <view class="risk-list">
          <view wx:for="{{riskIdentification.high_consumption_restriction_announcements.records}}" wx:key="id_card" class="risk-item">
            <view class="risk-item-header">
              <text class="risk-item-label">æ³•é™¢</text>
              <text class="risk-item-value">{{item.court}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">è¢«é™åˆ¶äººå‘˜</text>
              <text class="risk-item-value">{{item.restricted_person}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">é™åˆ¶æªæ–½</text>
              <text class="risk-item-value">{{item.measure}}</text>
            </view>
            <view class="risk-item-row">
              <text class="risk-item-label">ç”Ÿæ•ˆæ—¥æœŸ</text>
              <text class="risk-item-value">{{item.start_date}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ä¿¡è´·è¯„ä¼° -->
    <view class="section" wx:if="{{creditAssessment}}">
      <view class="section-title">
        <text class="title-icon">ğŸ’³</text>
        <text class="title-text">ä¿¡è´·è¯„ä¼°</text>
      </view>

      <!-- å€Ÿè´·æ„å‘è¡¨ç° -->
      <view wx:if="{{creditAssessment.loan_intention_by_customer_type}}" class="assessment-subsection">
        <view class="assessment-header">
          <text class="assessment-title">{{creditAssessment.loan_intention_by_customer_type.title}}</text>
        </view>
        <view class="assessment-list">
          <view wx:for="{{creditAssessment.loan_intention_by_customer_type.records}}" wx:key="customer_type" class="assessment-item">
            <view class="assessment-item-header">
              <text class="assessment-label">{{item.customer_type}}</text>
              <text class="assessment-value">{{item.application_count}}æ¬¡ç”³è¯·</text>
            </view>
            <view class="assessment-risk">
              <text class="risk-level">{{item.risk_level}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- å¼‚å¸¸æ—¶é—´æ®µå€Ÿè´·ç”³è¯· -->
      <view wx:if="{{creditAssessment.loan_intention_abnormal_times}}" class="assessment-subsection">
        <view class="assessment-header">
          <text class="assessment-title">{{creditAssessment.loan_intention_abnormal_times.title}}</text>
        </view>
        <view class="assessment-list">
          <view wx:for="{{creditAssessment.loan_intention_abnormal_times.records}}" wx:key="time_period" class="assessment-item">
            <view class="assessment-item-header">
              <text class="assessment-label">{{item.time_period}}</text>
            </view>
            <view class="assessment-item-row">
              <text class="assessment-detail-label">ä¸»å¯¼æœºæ„</text>
              <text class="assessment-detail-value">{{item.main_institution_type}}</text>
            </view>
            <view class="assessment-risk">
              <text class="risk-level">{{item.risk_level}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç§Ÿèµé£é™©è¯„ä¼° -->
    <view class="section" wx:if="{{leasingRiskAssessment}}">
      <view class="section-title">
        <text class="title-icon">ğŸš—</text>
        <text class="title-text">ç§Ÿèµé£é™©è¯„ä¼°</text>
      </view>

      <view wx:if="{{leasingRiskAssessment.multi_lender_risk_3c}}" class="leasing-subsection">
        <view class="leasing-header">
          <text class="leasing-title">{{leasingRiskAssessment.multi_lender_risk_3c.title}}</text>
        </view>
        <view class="leasing-list">
          <view wx:for="{{leasingRiskAssessment.multi_lender_risk_3c.records}}" wx:key="institution_type" class="leasing-item">
            <view class="leasing-item-header">
              <text class="leasing-label">{{item.institution_type}}</text>
              <text class="leasing-risk">{{item.risk_level}}</text>
            </view>
            <view class="leasing-stats">
              <view class="leasing-stat">
                <text class="stat-label">ç”³è¯·æœºæ„æ•°</text>
                <text class="stat-value">{{item.applied_count}}</text>
              </view>
              <view class="leasing-stat">
                <text class="stat-label">åœ¨ç”¨æœºæ„æ•°</text>
                <text class="stat-value">{{item.in_use_count}}</text>
              </view>
              <view class="leasing-stat">
                <text class="stat-label">æˆä¿¡æ€»é¢</text>
                <text class="stat-value">Â¥{{item.total_credit_limit}}</text>
              </view>
              <view class="leasing-stat">
                <text class="stat-label">è´Ÿå€ºæ€»é¢</text>
                <text class="stat-value">Â¥{{item.total_debt_balance}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç»¼åˆåˆ†æ -->
    <view class="section" wx:if="{{comprehensiveAnalysis && comprehensiveAnalysis.length > 0}}">
      <view class="section-title">
        <text class="title-icon">ğŸ“Š</text>
        <text class="title-text">ç»¼åˆåˆ†æ</text>
      </view>
      <view class="analysis-content">
        <view wx:for="{{comprehensiveAnalysis}}" wx:key="index" class="analysis-paragraph">
          <text>{{item}}</text>
        </view>
      </view>
    </view>

    <!-- äº§å“æ¨è -->
    <view class="section" wx:if="{{productRecommendations.length > 0}}">
      <view class="section-title">
        <text class="title-icon">ğŸ’³</text>
        <text class="title-text">äº§å“æ¨è</text>
      </view>

      <view class="product-list">
        <view wx:for="{{productRecommendations}}" wx:key="product_name" class="product-card-new">
          <!-- äº§å“æ ‡é¢˜æ  -->
          <view class="product-title-bar">
            <view class="product-bank">{{item.bank}}</view>
            <view class="product-rating-new">
              <text wx:for="{{item.rating}}" wx:for-item="star" wx:key="*this" class="star-icon">â­</text>
            </view>
          </view>

          <!-- äº§å“åç§° -->
          <view class="product-name-new">{{item.product_name}}</view>

          <!-- äº§å“è¯¦æƒ… -->
          <view class="product-details">
            <view class="detail-item">
              <text class="detail-label">æœ€é«˜é¢åº¦</text>
              <text class="detail-value">{{item.max_credit}}</text>
            </view>
            <view class="detail-divider"></view>
            <view class="detail-item">
              <text class="detail-label">å¹´åˆ©ç‡</text>
              <text class="detail-value">{{item.min_rate}}</text>
            </view>
          </view>

          <!-- æ¨èå»ºè®® -->
          <view class="product-recommendation">
            <text class="recommendation-label">ğŸ’¡ æ¨èç†ç”±</text>
            <text class="recommendation-text">{{item.suggestion}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- AIä¸“å®¶åˆ†æ -->
    <view class="section" wx:if="{{aiExpertAnalysis}}">
      <view class="section-title">
        <text class="title-icon">ğŸ¤–</text>
        <text class="title-text">AIä¸“å®¶åˆ†æ</text>
      </view>

      <!-- é€‚åˆåº¦è¯„çº§å¡ç‰‡ -->
      <view class="ai-suitability-card">
        <view class="ai-suitability-icon">ğŸ¯</view>
        <text class="ai-suitability-label">è´·æ¬¾ç”³è¯·é€‚åˆåº¦</text>
        <text class="ai-suitability-value">{{aiExpertAnalysis.suitability_rating}}</text>
      </view>

      <!-- æ€»ç»“æ€§åˆ†æ -->
      <view class="ai-subsection">
        <view class="ai-subsection-header">
          <text class="ai-subsection-icon">ğŸ“Š</text>
          <text class="ai-subsection-title">æ€»ç»“æ€§åˆ†æ</text>
        </view>
        <view class="ai-analysis-list">
          <view wx:for="{{aiExpertAnalysis.analysis_points}}" wx:key="number" class="ai-analysis-item">
            <view class="ai-point-number">{{item.number}}</view>
            <text class="ai-point-content">{{item.content}}</text>
          </view>
        </view>
      </view>

      <!-- ä¼˜åŒ–å»ºè®® -->
      <view class="ai-subsection">
        <view class="ai-subsection-header">
          <text class="ai-subsection-icon">ğŸ’¡</text>
          <text class="ai-subsection-title">ä¼˜åŒ–å»ºè®®</text>
        </view>
        <view class="ai-suggestions-list">
          <view wx:for="{{aiExpertAnalysis.optimization_suggestions}}" wx:key="index" class="ai-suggestion-item">
            <text class="ai-suggestion-bullet">â€¢</text>
            <text class="ai-suggestion-text">{{item}}</text>
          </view>
        </view>
      </view>

      <!-- é£é™©æç¤º -->
      <view class="ai-risk-card">
        <view class="ai-risk-header">
          <text class="ai-risk-icon">âš ï¸</text>
          <text class="ai-risk-title">é£é™©æç¤º</text>
        </view>
        <text class="ai-risk-text">{{aiExpertAnalysis.risk_warning}}</text>
      </view>
    </view>

    <!-- æŠ¥å‘Šé¡µè„š -->
    <view class="section report-footer-section" wx:if="{{reportFooter}}">
      <view class="footer-content">
        <text class="footer-source">{{reportFooter.data_source}}</text>
        <text class="footer-time">ç”Ÿæˆæ—¶é—´: {{reportFooter.generation_time}}</text>
        <text class="footer-disclaimer">{{reportFooter.disclaimer}}</text>
      </view>
    </view>

    <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="action-button primary" bindtap="downloadPDFReport">
        <text class="button-icon">ğŸ“¥</text>
        <text class="button-text">ä¸‹è½½PDFæŠ¥å‘Š</text>
      </button>
      <button class="action-button" open-type="share">
        <text class="button-icon">ğŸ“¤</text>
        <text class="button-text">åˆ†äº«æŠ¥å‘Š</text>
      </button>
    </view>
  </view>
</view>

